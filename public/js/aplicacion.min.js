function replaceAll(a,c,b){while(a.toString().indexOf(c)!=-1){a=a.toString().replace(c,b);}return a;}var puntaje=function(a,b){$(a).raty({readOnly:true,score:b,starOff:"/img/t2.png",starOn:"/img/t1.png"});
};function regresar(){$("#mapa-buscador").hide();$("#esconder").css("display","block");$("#esconder2").css("display","block");}function initSucursales(){var g;
var n=document.getElementById("mapCont");var f=$("#mapCont").data("lat");var j=$("#mapCont").data("lng");var b=Array();var d=new google.maps.MarkerImage("/img/point.png",new google.maps.Size(26,32),new google.maps.Point(0,0));
var r=new google.maps.MarkerImage("/img/point.png",new google.maps.Size(26,32),new google.maps.Point(0,0));var m=new google.maps.LatLng(f,j);var q={center:m,zoom:17,mapTypeId:google.maps.MapTypeId.ROADMAP,backgroundColor:"#ffffff",disableDefaultUI:true,navigationControl:true,navigationControlOptions:{position:google.maps.ControlPosition.TOP_RIGHT,style:google.maps.NavigationControlStyle.SMALL}};
var l=new google.maps.Map(n,q);var p=Array();function k(t,s){place=new google.maps.LatLng(t.lat,t.lng);var u=new google.maps.Marker({icon:s,position:place,map:l,title:t.title,zIndex:100});
i=t.index;(function(w,v){google.maps.event.addListener(v,"click",function(){h(v,w);});})(i,u);return u;}function g(s){var t;for(var v=0;v<s.length;v++){if(s[v].lat){var u=k(s[v],d);
b[v]=u;}}}$(".list-suc .ul-suc li a").each(function(v){var s=$(this).data("lat");var u=$(this).data("lng");var t=$(this).find("h6").text();p[v]=new Object();
p[v].lat=s;p[v].lng=u;p[v].title=t;p[v].index=v;});g(p);var e={lat:f,lng:j,index:b.length};b.push(k(e,r));function a(){$(b).each(function(){this.setIcon(d);
});}function h(s,t){if(t==null){a();s.setIcon(r);l.panTo(s.getPosition());}else{if(t==(b.length-1)){c();}else{$(".list-suc .ul-suc li a").eq(t).trigger("click");
}}}function c(){$("h4.ubi-map span").html("");index=b.length-1;h(b[index],null);$(".ubicancion").effect("highlight",{},1000);$(".list-suc .ul-suc li a.activo").removeClass("activo");
}function o(x){var s=$(this).data("lat");var w=$(this).data("lng");var v=$(".list-suc .ul-suc li a").index(this);var t=$(this).find(".phone span").text();
var u=$(x.target);$(".list-suc .ul-suc li a.activo").removeClass("activo");if(u.is("span.close-banch")){c();}else{$(this).addClass("activo");$("h4.ubi-map span").html(" : <span class='co_l'>"+t+"</span>");
h(b[v],null);}return false;}$(".list-suc .ul-suc li a").on("click",o);}$(document).ready(function(){$("input, textarea").placeholder();if($.browser.mozilla){$(".verlistado").css("padding-top","15px");
}$(".agregar-coment-1").click(function(a){a.preventDefault();if($(".agregar-comentario-desc").is(":hidden")){$(".agregar-comentario-desc").show("slow");
}else{$(".agregar-comentario-desc").slideUp();}});$(".cover").mosaic({animation:"slide",anchor_y:"top",hover_y:"300px"});$(".subir").hide();$(window).scroll(function(){if($(this).scrollTop()>100){$(".subir").fadeIn();
$("#ver").fadeOut();}else{$(".subir").fadeOut();$("#ver").fadeIn();}});$(".subir a").click(function(){$("body,html").animate({scrollTop:0},500);return false;
});$("#ver").on("click",function(b){b.preventDefault();var a=$(this).attr("href");switch(a){case"#cate-home":offset=$(a).offset().top-20;break;default:offset=$(a).offset().top;
break;}$("html, body").animate({scrollTop:offset},"slow");});$("#bubi #q").keyup(function(){if(($(this).val()!="")&&($("#bubi #fq").val()!="seleccione distrito")){$("#buscarmap").removeClass("disabled").addClass("map");
$("#buscarmap").attr("href","#");$("#buscarmap").removeAttr("disabled");$("#buscarmap").fadeIn();}if($(this).val()==""){$("#buscarmap").hide();}}).keyup();
$("#buscarmap").on("click",function(){var a=$("#bubi #q").val();var c=$("#bubi #fq").val();var d=urlJson+"/jsonmapasa?distrito="+c+"&q="+a;$("#map").remove();
$("#subir-home").remove();$(".mensaje").remove();$(".mensaje2").remove();$("#mapa-buscador").append("<div id='map' style='height:800px;'></div>");$("#esconder").css("display","none");
$("#esconder2").css("display","none");if(($("#bubi #q").val()!="")&&($("#bubi #fq").val()!="seleccione")){$("#mapa-buscador").fadeIn();$("#search #q").attr("value",a);
var b=$.getJSON(d,function(e){if(e.response.numFound>=1){map=new GMaps({el:"#map",zoom:12,lat:-12.043333,lng:-77.028333});$.each(e.response.docs,function(o,m){map.setCenter(m.latitud,m.longitud);
var f=m.tx_descripcion;var p=f.substring(0,50);var g=replaceAll(m.name," ","-");var h=replaceAll(m.distrito," ","-");var n=m.va_imagen;if(n=="platos-default.png"){map.addMarker({lat:m.latitud,lng:m.longitud,icon:{size:new google.maps.Size(32,37),url:"/img/icomap.png"},title:m.restaurante,infoWindow:{content:"<img src="+urlJson+"/imagenes/defecto/"+m.va_imagen+" class='img-mapa'><p class='restaurante-map'><a href=/plato/"+g+"-"+m.id+">"+m.restaurante+"</a></p><p class='plato-map'>"+m.name+"</p><p class='txt-map'>"+p+"...</p><a class='a-map' href=/plato/"+g+"-"+m.id+"> ver mas </a>"}});
}else{map.addMarker({lat:m.latitud,lng:m.longitud,icon:{size:new google.maps.Size(32,37),url:"/img/icomap.png"},title:m.restaurante,infoWindow:{content:"<img src="+urlJson+"/imagenes/plato/general/"+m.va_imagen+" class='img-mapa'><p class='restaurante-map'><a href=/plato/"+g+"-"+m.id+">"+m.restaurante+"</a></p><p class='plato-map'>"+m.name+"</p><p class='txt-map'>"+p+"...</p><a class='a-map' href=/plato/"+g+"-"+m.id+"> ver mas </a>"}});
}});}else{$("#mapa-buscador").hide();$(".descrip-product").remove();$("#subir-home").remove();$(".content-left").css("height","100px");$(".mensaje").remove();
$(".mensaje2").remove();$(".contenido-plato").css("background","url(/img/back-detalle.png) repeat");$(".contenido-plato").append('<p class="mensaje">"Lamentamos no haber encontrado lo que estabas buscando pero tenemos muchas mas opciones para ti.</p><p class="mensaje2">También tenemos una opción para que nos escribas si deseas registrar un nuevo plato.</p>');
$(".contenido-plato").append('<div class="recomendados-platos primer-home" id="subir-home" style="padding-bottom: 90px;"></div>');$("#subir-home").append('<div class="sub" style="margin-top: 10px;margin-bottom: 15px;background: url(/img/img-resultados.png);width: 41%;padding: 0.9em 0px;"><span  style="padding-left: 10px;color:white;font-weight: bold;">Platos Destacados</span></div>');
$("#subir-home").append('<ul id="listajson"></ul>');$.getJSON(urlJson+"/jsondesta",function(f){$.each(f,function(g,k){var l=replaceAll(k.va_nombre," ","-");
var h=k.va_imagen;if(h=="platos-default.png"){$("#listajson").append('<li><div class="plato_r"><div class="mosaic-block cover2"><div class="mosaic-overlay"><span>'+k.va_nombre+"</span><img src="+urlJson+"/imagenes/defecto/"+k.va_imagen+' class="img-plato"><img src="/img/mas.png" alt="" class="mas"></div><a href="/plato/'+l+"-"+k.in_id+'" class="mosaic-backdrop"><div class="details"><h4>'+k.va_nombre+'</h4><p class="title-details" style="font-weight: bold;">Descripción</p><p class="desc-plato" style="font-size:0.9em;">'+k.tx_descripcion+'</p></div></a></div><div class="foo"><p class="nom_res">'+k.restaurant_nombre+'</p><div class="pt"><p class="com">'+k.NumeroComentarios+' <i class="icon-comment"></i></p><div class="punt"><div class="puntuaciones c'+k.Ta_puntaje_in_id+'"></div></div></div></div></div></li>');
}else{$("#listajson").append('<li><div class="plato_r"><div class="mosaic-block cover2"><div class="mosaic-overlay"><span>'+k.va_nombre+"</span><img src="+urlJson+"/imagenes/plato/destacado/"+k.va_imagen+' class="img-plato"><img src="/img/mas.png" alt="" class="mas"></div><a href="/plato/'+l+"-"+k.in_id+'" class="mosaic-backdrop"><div class="details"><h4>'+k.va_nombre+'</h4><p class="title-details" style="font-weight: bold;">Descripción</p><p class="desc-plato" style="font-size:0.9em;">'+k.tx_descripcion+'</p></div></a></div><div class="foo"><p class="nom_res">'+k.restaurant_nombre+'</p><div class="pt"><p class="com">'+k.NumeroComentarios+' <i class="icon-comment"></i></p><div class="punt"><div class="puntuaciones c'+k.Ta_puntaje_in_id+'"></div></div></div></div></div></li>');
}});$(".cover2").mosaic({animation:"slide",anchor_y:"top",hover_y:"300px"});});}});b.fail(function(e,f,g){var h=f+", "+g;console.log(h);$("#mapa-buscador").hide();
$(".descrip-product").remove();$("#subir-home").remove();$(".content-left").css("height","100px");$(".mensaje").remove();$(".mensaje2").remove();$(".contenido-plato").css("background","url(/img/back-detalle.png) repeat");
$(".contenido-plato").append('<p class="mensaje">"Lamentamos no haber encontrado lo que estabas buscando pero tenemos muchas mas opciones para ti.</p><p class="mensaje2">También tenemos una opción para que nos escribas si deseas registrar un nuevo plato.</p>');
$(".contenido-plato").append('<div class="recomendados-platos primer-home" id="subir-home" style="padding-bottom: 90px;"></div>');$("#subir-home").append('<div class="sub" style="margin-top: 10px;margin-bottom: 15px;background: url(/img/img-resultados.png);width: 41%;padding: 0.9em 0px;"><span  style="padding-left: 10px;color:white;font-weight: bold;">Platos Destacados</span></div>');
$("#subir-home").append('<ul id="listajson"></ul>');$.getJSON(urlJson+"/jsondesta",function(k){$.each(k,function(j,n){var o=replaceAll(n.va_nombre," ","-");
var p=n.va_imagen;if(p=="platos-default.png"){$("#listajson").append('<li><div class="plato_r"><div class="mosaic-block cover2"><div class="mosaic-overlay"><span>'+n.va_nombre+"</span><img src="+urlJson+"magenes/defecto/"+n.va_imagen+'class="img-plato"><img src="/img/mas.png" alt="" class="mas"></div><a href="/plato/'+o+"-"+n.in_id+'" class="mosaic-backdrop"><div class="details"><h4>'+n.va_nombre+'</h4><p class="title-details" style="font-weight: bold;">Descripción</p><p class="desc-plato" style="font-size:0.9em;">'+n.tx_descripcion+'</p></div></a></div><div class="foo"><p class="nom_res">'+n.restaurant_nombre+'</p><div class="pt"><p class="com">'+n.NumeroComentarios+' <i class="icon-comment"></i></p><div class="punt"><div class="puntuaciones c'+n.Ta_puntaje_in_id+'"></div></div></div></div></div></li>');
}else{$("#listajson").append('<li><div class="plato_r"><div class="mosaic-block cover2"><div class="mosaic-overlay"><span>'+g.va_nombre+"</span><img src="+urlJson+"/imagenes/plato/destacado/"+g.va_imagen+' class="img-plato"><img src="/img/mas.png" alt="" class="mas"></div><a href="/plato/'+h+"-"+g.in_id+'" class="mosaic-backdrop"><div class="details"><h4>'+g.va_nombre+'</h4><p class="title-details" style="font-weight: bold;">Descripción</p><p class="desc-plato" style="font-size:0.9em;">'+g.tx_descripcion+'</p></div></a></div><div class="foo"><p class="nom_res">'+g.restaurant_nombre+'</p><div class="pt"><p class="com">'+g.NumeroComentarios+' <i class="icon-comment"></i></p><div class="punt"><div class="puntuaciones c'+g.Ta_puntaje_in_id+'"></div></div></div></div></div></li>');
}});$(".cover2").mosaic({animation:"slide",anchor_y:"top",hover_y:"300px"});});});}else{$("#mapa-buscador").hide();alert("debe ingresar el plato");}});
});$("#bubi #fq").change(function(a){if(($("#bubi #q").val()!="")&&($("#bubi #fq").val()!="seleccione distrito")){$("#buscarmap").removeClass("disabled").addClass("map");
$("#buscarmap").attr("href","#");$("#buscarmap").removeAttr("disabled");$("#buscarmap").fadeIn();}if($(this).val()=="seleccione distrito"){$("#buscarmap").hide();
}});
